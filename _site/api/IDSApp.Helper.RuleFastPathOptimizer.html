<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class RuleFastPathOptimizer | mysite </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class RuleFastPathOptimizer | mysite ">
      
      <meta name="description" content="High-performance rule checking optimization system using Bloom Filters technology Main Responsibilities:  Create and manage Bloom Filters for fast rule filtering Reduce number of rules needing detailed inspection Provide automatic performance statistics and optimization Manage cache for inspection results  How It Works:  Group rules by protocol and common ports Build Bloom Filters for each rule group Use filters for quick match possibility checking Skip detailed inspection when filters confirm no possible match  Features:  Significant rule inspection performance improvement Automatic adaptation to rule changes Continuous system accuracy monitoring Automatic rebuild when efficiency decreases">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="mysite">
            mysite
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="IDSApp.Helper.RuleFastPathOptimizer">



  <h1 id="IDSApp_Helper_RuleFastPathOptimizer" data-uid="IDSApp.Helper.RuleFastPathOptimizer" class="text-break">
Class RuleFastPathOptimizer  
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="IDSApp.html">IDSApp</a>.<a class="xref" href="IDSApp.Helper.html">Helper</a></dd></dl>
  <dl><dt>Assembly</dt><dd>IDSApp.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>High-performance rule checking optimization system using Bloom Filters technology</p>
<p>Main Responsibilities:</p>
<ul>
<li>Create and manage Bloom Filters for fast rule filtering</li>
<li>Reduce number of rules needing detailed inspection</li>
<li>Provide automatic performance statistics and optimization</li>
<li>Manage cache for inspection results</li>
</ul>
<p>How It Works:</p>
<ol>
<li>Group rules by protocol and common ports</li>
<li>Build Bloom Filters for each rule group</li>
<li>Use filters for quick match possibility checking</li>
<li>Skip detailed inspection when filters confirm no possible match</li>
</ol>
<p>Features:</p>
<ul>
<li>Significant rule inspection performance improvement</li>
<li>Automatic adaptation to rule changes</li>
<li>Continuous system accuracy monitoring</li>
<li>Automatic rebuild when efficiency decreases</li>
</ul>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class RuleFastPathOptimizer</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">RuleFastPathOptimizer</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>






  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="IDSApp_Helper_RuleFastPathOptimizer__ctor_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.#ctor*"></a>

  <h3 id="IDSApp_Helper_RuleFastPathOptimizer__ctor_System_Boolean_System_Int32_System_Double_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.#ctor(System.Boolean,System.Int32,System.Double)">
  RuleFastPathOptimizer(bool, int, double)
  
  </h3>

  <div class="markdown level1 summary"><p>Initialize Rule Fast Path Optimizer</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public RuleFastPathOptimizer(bool debug = false, int rebuildIntervalMinutes = 10, double fppThresholdPercent = 5)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>debug</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>Enable debug mode for detailed logging</p>
</dd>
    <dt><code>rebuildIntervalMinutes</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>Auto-rebuild interval in minutes</p>
</dd>
    <dt><code>fppThresholdPercent</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>False positive rate threshold before rebuild</p>
</dd>
  </dl>












  <h2 class="section" id="methods">Methods
</h2>


  <a id="IDSApp_Helper_RuleFastPathOptimizer_BuildBloomFilters_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.BuildBloomFilters*"></a>

  <h3 id="IDSApp_Helper_RuleFastPathOptimizer_BuildBloomFilters_System_Collections_Generic_List_IDSApp_Entity_Signatures__" data-uid="IDSApp.Helper.RuleFastPathOptimizer.BuildBloomFilters(System.Collections.Generic.List{IDSApp.Entity.Signatures})">
  BuildBloomFilters(List&lt;Signatures&gt;)
  
  </h3>

  <div class="markdown level1 summary"><p>Build Bloom Filters from provided rules
Groups rules by protocol and creates filters for common ports</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void BuildBloomFilters(List&lt;Signatures&gt; rules)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>rules</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="IDSApp.Entity.Signatures.html">Signatures</a>&gt;</dt>
    <dd><p>List of security rules to optimize</p>
</dd>
  </dl>












  <a id="IDSApp_Helper_RuleFastPathOptimizer_GetOptimizationStats_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.GetOptimizationStats*"></a>

  <h3 id="IDSApp_Helper_RuleFastPathOptimizer_GetOptimizationStats" data-uid="IDSApp.Helper.RuleFastPathOptimizer.GetOptimizationStats">
  GetOptimizationStats()
  
  </h3>

  <div class="markdown level1 summary"><p>Get current optimization statistics</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public RuleOptimizationStats GetOptimizationStats()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="IDSApp.Helper.RuleOptimizationStats.html">RuleOptimizationStats</a></dt>
    <dd></dd>
  </dl>











  <a id="IDSApp_Helper_RuleFastPathOptimizer_PrintOptimizationInfo_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.PrintOptimizationInfo*"></a>

  <h3 id="IDSApp_Helper_RuleFastPathOptimizer_PrintOptimizationInfo" data-uid="IDSApp.Helper.RuleFastPathOptimizer.PrintOptimizationInfo">
  PrintOptimizationInfo()
  
  </h3>

  <div class="markdown level1 summary"><p>Print optimization information to console</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void PrintOptimizationInfo()</code></pre>
  </div>













  <a id="IDSApp_Helper_RuleFastPathOptimizer_ShouldCheckRules_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.ShouldCheckRules*"></a>

  <h3 id="IDSApp_Helper_RuleFastPathOptimizer_ShouldCheckRules_System_String_System_Int32_System_Int32_System_String_System_Int32_System_String_" data-uid="IDSApp.Helper.RuleFastPathOptimizer.ShouldCheckRules(System.String,System.Int32,System.Int32,System.String,System.Int32,System.String)">
  ShouldCheckRules(string, int, int, string, int, string)
  
  </h3>

  <div class="markdown level1 summary"><p>Determine if rules should be checked for given network parameters
Uses Bloom Filters for fast path optimization</p>
<p>⚠️ CURRENTLY DISABLED: Returns true always to ensure all rules are checked
until fast path system is fully validated</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool ShouldCheckRules(string protocol, int dstPort, int payloadLength, string ruleGroup, int srcPort = 0, string flowDirection = &quot;&quot;)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>protocol</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
    <dt><code>dstPort</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
    <dt><code>payloadLength</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
    <dt><code>ruleGroup</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
    <dt><code>srcPort</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
    <dt><code>flowDirection</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>












</article>

        <div class="contribution d-print-none">
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
