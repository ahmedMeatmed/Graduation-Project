<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class EnhancedRuleParser | mysite </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class EnhancedRuleParser | mysite ">
      
      <meta name="description" content="Advanced rule parsing and analysis system for Intrusion Detection System (IDS) Main Responsibilities:  Parse and extract conditions from security rules in multiple protocols Analyze network traffic against parsed rule conditions Validate rule syntax and semantics Extract metadata and content patterns from rules  Supported Protocols:  HTTP/HTTPS traffic analysis TLS/SSL certificate inspection DNS query and response parsing ICMP packet analysis Network flow and connection tracking  Features:  High-performance regex-based parsing Comprehensive protocol support Rule validation and error checking TLS fingerprinting and certificate analysis Content pattern extraction and normalization">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="mysite">
            mysite
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="IDSApp.Helper.EnhancedRuleParser">



  <h1 id="IDSApp_Helper_EnhancedRuleParser" data-uid="IDSApp.Helper.EnhancedRuleParser" class="text-break">
Class EnhancedRuleParser  
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="IDSApp.html">IDSApp</a>.<a class="xref" href="IDSApp.Helper.html">Helper</a></dd></dl>
  <dl><dt>Assembly</dt><dd>IDSApp.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Advanced rule parsing and analysis system for Intrusion Detection System (IDS)</p>
<p>Main Responsibilities:</p>
<ul>
<li>Parse and extract conditions from security rules in multiple protocols</li>
<li>Analyze network traffic against parsed rule conditions</li>
<li>Validate rule syntax and semantics</li>
<li>Extract metadata and content patterns from rules</li>
</ul>
<p>Supported Protocols:</p>
<ul>
<li>HTTP/HTTPS traffic analysis</li>
<li>TLS/SSL certificate inspection</li>
<li>DNS query and response parsing</li>
<li>ICMP packet analysis</li>
<li>Network flow and connection tracking</li>
</ul>
<p>Features:</p>
<ul>
<li>High-performance regex-based parsing</li>
<li>Comprehensive protocol support</li>
<li>Rule validation and error checking</li>
<li>TLS fingerprinting and certificate analysis</li>
<li>Content pattern extraction and normalization</li>
</ul>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class EnhancedRuleParser</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">EnhancedRuleParser</span></div>
    </dd>
  </dl>



  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
  </dd></dl>






  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="IDSApp_Helper_EnhancedRuleParser__ctor_" data-uid="IDSApp.Helper.EnhancedRuleParser.#ctor*"></a>

  <h3 id="IDSApp_Helper_EnhancedRuleParser__ctor" data-uid="IDSApp.Helper.EnhancedRuleParser.#ctor">
  EnhancedRuleParser()
  
  </h3>

  <div class="markdown level1 summary"></div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public EnhancedRuleParser()</code></pre>
  </div>













  <h2 class="section" id="methods">Methods
</h2>


  <a id="IDSApp_Helper_EnhancedRuleParser_ParseConditions_" data-uid="IDSApp.Helper.EnhancedRuleParser.ParseConditions*"></a>

  <h3 id="IDSApp_Helper_EnhancedRuleParser_ParseConditions_IDSApp_Entity_Signatures_" data-uid="IDSApp.Helper.EnhancedRuleParser.ParseConditions(IDSApp.Entity.Signatures)">
  ParseConditions(Signatures)
  
  </h3>

  <div class="markdown level1 summary"><p>Parse all conditions from a security rule into structured format
Extracts HTTP, TLS, DNS, ICMP, network, and metadata conditions</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ParsedRuleConditions ParseConditions(Signatures rule)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>rule</code> <a class="xref" href="IDSApp.Entity.Signatures.html">Signatures</a></dt>
    <dd><p>The security rule to parse</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="IDSApp.Helper.ParsedRuleConditions.html">ParsedRuleConditions</a></dt>
    <dd><p>Structured rule conditions</p>
</dd>
  </dl>











  <a id="IDSApp_Helper_EnhancedRuleParser_ParseTlsPacket_" data-uid="IDSApp.Helper.EnhancedRuleParser.ParseTlsPacket*"></a>

  <h3 id="IDSApp_Helper_EnhancedRuleParser_ParseTlsPacket_System_Byte___" data-uid="IDSApp.Helper.EnhancedRuleParser.ParseTlsPacket(System.Byte[])">
  ParseTlsPacket(byte[])
  
  </h3>

  <div class="markdown level1 summary"><p>Parse TLS handshake packet and extract security information</p>
<p>Returns:</p>
<ul>
<li>SNI (Server Name Indication)</li>
<li>TLS version</li>
<li>Cipher suite</li>
<li>Certificate fingerprint</li>
<li>JA3 fingerprint (for client hello)</li>
<li>Certificate subject and issuer</li>
<li>Certificate validity dates</li>
</ul>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public (string sni, string version, string cipherSuite, string certFingerprint, string ja3Fingerprint, string subject, string issuer, DateTime? notBefore, DateTime? notAfter) ParseTlsPacket(byte[] payload)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>payload</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.byte">byte</a>[]</dt>
    <dd></dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt>(<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.sni">sni</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.version">version</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.ciphersuite">cipherSuite</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.certfingerprint">certFingerprint</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.ja3fingerprint">ja3Fingerprint</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.subject">subject</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.issuer">issuer</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.datetime">DateTime</a>? <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.notbefore">notBefore</a>, <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.datetime">DateTime</a>? <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetuple-system.string,system.string,system.string,system.string,system.string,system.string,system.string,system.valuetuple-system.nullable-system.datetime-,system.nullable-system.datetime---.notafter">notAfter</a>)</dt>
    <dd></dd>
  </dl>











  <a id="IDSApp_Helper_EnhancedRuleParser_ValidateRule_" data-uid="IDSApp.Helper.EnhancedRuleParser.ValidateRule*"></a>

  <h3 id="IDSApp_Helper_EnhancedRuleParser_ValidateRule_IDSApp_Entity_Signatures_System_Collections_Generic_List_System_String___" data-uid="IDSApp.Helper.EnhancedRuleParser.ValidateRule(IDSApp.Entity.Signatures,System.Collections.Generic.List{System.String}@)">
  ValidateRule(Signatures, out List&lt;string&gt;)
  
  </h3>

  <div class="markdown level1 summary"><p>Validate rule syntax and semantics
Checks for valid patterns, IPs, ports, and protocol-specific conditions</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool ValidateRule(Signatures rule, out List&lt;string&gt; validationErrors)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>rule</code> <a class="xref" href="IDSApp.Entity.Signatures.html">Signatures</a></dt>
    <dd></dd>
    <dt><code>validationErrors</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>&gt;</dt>
    <dd></dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd></dd>
  </dl>












</article>

        <div class="contribution d-print-none">
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
